
# Excel起動時の証明書エラー対処法

Excel起動時にアドイン/マクロの証明書が見つからない場合、以下の手順で解消する。

1. 証明書インストール
    1. `draemon_ash2.cer`をクリックして、証明書をインストールする。
    1. `Win + R` 押下後、`certmgr.msc` を実行する。
    1. 個人 -> 証明書 を開く。
    1. `draemon_ash2` がインストールされていることを確認する。
1. 証明書有効化
    1. Excelを起動する。
        - セキュリティの警告により「マクロが無効にされました」と表示される
    1. VBEを起動する。（`Shift + F11`)
    1. VBEのメニューバー「ツール(T)」->「デジタル署名(D)...」をクリックする。
    1. 「削除(R)」をクリックして、既存の証明書を削除する。
    1. 「選択(C)...」をクリック後、`draemon_ash2`を選択して、証明書を有効化する。
    1. `Ctrl + S`で保存する。
    1. VBEを終了する。
    1. Excelを再起動する。
    1. メニューバー上部 「コンテンツの有効化」をクリックする。

# 【参考】証明書作成方法

[証明書を作成する方法](https://kunohe.tech/outlook-vba/1344/)は以下の通り。

1. 証明書作成
    1. SELFCERT.EXEを探す。(Windowsのバージョンに依存する)
        - 例１）C:\Program Files (x86)\Microsoft Office\root\Office16\SELFCERT.EXE
        - 例２）C:\Program Files\Microsoft Office 15\root\office15\SELFCERT.EXE
    1. SELFCERT.EXEを実行する。
    1. 証明書の名前を設定する。(e.g. `draemon_ash2`)
1. 証明書エクスポート
    1. `Win + R` 押下後、`certmgr.msc` を実行する。
    1. 個人 -> 証明書 を開く。
    1. 指定した証明書がインストールされていることを確認する。
    1. 証明書を選択して右クリック->「すべてのタスク(K)」->「エクスポート(E)...」
    1. すべての選択肢をデフォルトとしたまま「次へ」で進めて、エクスポートを完了させる。

